{% extends "layout.html" %}

{% block main %}
    <button id="download-button" hidden onclick="downloadCSV()">Download CSV file of data</button>
    <table id="resp-table" class="table table-striped table-bordered" style="width:100%">
        <thead>
            <tr id="header-row">
                <th>Number</th>
                <th>Subject 1</th>
                <th>Subject 2</th>
                <th>Subject 3</th>
                <th>Subject 4</th>
            </tr>
        </thead>
        
        {% for combo in combos %}
        <tr class="table-row">
                <td class="table-cell">{{ combo | length }}</td>
            {% for subject in combo %}
                <td class="table-cell">{{ subject }}</td>
            {% endfor %}
            {% for i in range(4 - combo|length) %}
                <td class="table-cell"></td>
            {% endfor %}
        </tr>
        {% endfor %}
    </table>

    <script>
        function downloadCSV() {
            var csv_array = [];
            var header_array = [];
            $("#header-row > th").each(function() {
                header_array.push($(this).text());
            });
            csv_array.push(header_array.join(","));
            $(".table-row").each(function() {
                var row_array = [];
                $(this).find("td").each(function() {
                    row_array.push($(this).text());
                });
                csv_array.push(row_array.join(","));
            });
            console.log(csv_array.join("\n"));
        }
        // Taken some taken from https://datatables.net/examples/styling/bootstrap4
        $(document).ready(function() {
            $('.table-cell').text(function() {
                $(this).css("text-align", "center");
            });
            $('#resp-table').DataTable();
        } );
    </script>

{% endblock %}